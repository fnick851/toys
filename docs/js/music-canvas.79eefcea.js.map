{"version":3,"sources":["webpack:///./src/views/MusicCanvas.vue?b70e","webpack:///./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./src/classes/music-canvas/BufferLoader.js","webpack:///./src/classes/music-canvas/Audio.js","webpack:///./src/classes/music-canvas/View.js","webpack:///src/views/MusicCanvas.vue","webpack:///./src/views/MusicCanvas.vue?30e9","webpack:///./src/views/MusicCanvas.vue","webpack:///./node_modules/core-js/internals/array-fill.js","webpack:///./node_modules/core-js/modules/es.array.fill.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","on","$event","playNote","staticRenderFns","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","BufferLoader","context","urlList","callback","onload","bufferList","Array","loadCount","url","index","request","XMLHttpRequest","open","responseType","decodeAudioData","response","buffer","alert","error","onerror","send","loadBuffer","Audio","gainNode","undefined","audioContext","window","AudioContext","webkitAudioContext","createGain","gain","value","connect","destination","sound","createBufferSource","start","stop","currentTime","View","canvas","audio","clicks","frameRate","loopRate","maxRadius","event","x","offsetX","y","offsetY","pos","push","radius","play","setInterval","getContext","clearRect","width","height","fillStyle","fillRect","circle","alpha","drawCircle","beginPath","arc","Math","PI","fill","name","data","view","created","mounted","setCanvasSize","onresize","methods","handleClick","bind","e","watch","newView","updateDisplay","component","toObject","toAbsoluteIndex","toLength","module","exports","O","argumentsLength","arguments","end","endPos","$","addToUnscopables","proto"],"mappings":"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","file":"js/music-canvas.79eefcea.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{ref:\"canvas\",on:{\"click\":function($event){return _vm.playNote($event)}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","class BufferLoader {\n  constructor(context, urlList, callback) {\n    this.context = context\n    this.urlList = urlList\n    this.onload = callback\n    this.bufferList = new Array()\n    this.loadCount = 0\n  }\n\n  loadBuffer(url, index) {\n    // Load buffer asynchronously\n    const request = new XMLHttpRequest()\n    request.open('GET', url, true)\n    request.responseType = 'arraybuffer'\n    request.onload = () => {\n      // Asynchronously decode the audio file data in request.response\n      this.context.decodeAudioData(\n        request.response,\n        buffer => {\n          if (!buffer) {\n            alert('error decoding file data: ' + url)\n            return\n          }\n          this.bufferList[index] = buffer\n          if (++this.loadCount == this.urlList.length)\n            this.onload(this.bufferList)\n        },\n        error => {\n          alert('decodeAudioData error', error)\n        },\n      )\n    }\n    request.onerror = () => {\n      alert('BufferLoader: XHR error')\n    }\n    request.send()\n  }\n\n  load() {\n    for (let i = 0; i < this.urlList.length; ++i) {\n      this.loadBuffer(`audio/${this.urlList[i]}`, i)\n    }\n  }\n}\n\nexport default BufferLoader\n","class Audio {\n  constructor() {\n    this.gainNode = undefined\n    this.bufferList = undefined\n    this.audioContext = new (window.AudioContext || window.webkitAudioContext)()\n  }\n\n  init(bufferList) {\n    this.bufferList = bufferList\n    this.gainNode = this.audioContext.createGain()\n    this.gainNode.gain.value = 1\n    this.gainNode.connect(this.audioContext.destination)\n  }\n\n  play(i) {\n    const sound = this.audioContext.createBufferSource()\n    sound.connect(this.gainNode)\n    sound.buffer = this.bufferList[i]\n    sound.start(0)\n    sound.stop(this.audioContext.currentTime + 18)\n  }\n}\n\nexport default Audio\n","class View {\n  constructor(canvas, audio) {\n    this.canvas = canvas\n    this.audio = audio\n    this.clicks = []\n    this.frameRate = 1000 / 30\n    this.loopRate = 4000\n    this.maxRadius = 80\n  }\n\n  handleClick(event) {\n    const x = event.offsetX\n    const y = event.offsetY\n    const pos = this.clicks.push({ x: x, y: y, radius: 0 })\n    this.audio.play(x % 10)\n    setInterval(() => {\n      this.clicks[pos - 1].radius = 0\n      this.audio.play(x % 10)\n    }, this.loopRate)\n  }\n\n  updateDisplay() {\n    const context = this.canvas.getContext('2d')\n    context.clearRect(0, 0, this.canvas.width, this.canvas.height)\n    context.fillStyle = 'black'\n    context.fillRect(0, 0, this.canvas.width, this.canvas.height)\n    for (let i = 0; i < this.clicks.length; i++) {\n      const circle = this.clicks[i]\n      if (circle.radius > this.maxRadius) continue\n      circle.radius += 1\n      let alpha = 0.7\n      if (circle.radius > this.maxRadius - 15)\n        alpha = (this.maxRadius - circle.radius) / 10\n      this.drawCircle(context, circle.x, circle.y, circle.radius, alpha)\n    }\n  }\n\n  drawCircle(context, x, y, radius, alpha) {\n    context.beginPath()\n    context.arc(x, y, radius, 0, 2 * Math.PI)\n    context.fillStyle =\n      'rgba(' +\n      (x % 256) +\n      ', ' +\n      (y % 256) +\n      ', ' +\n      ((x * y) % 256) +\n      ' ,' +\n      alpha +\n      ')'\n    context.fill()\n  }\n}\n\nexport default View\n","<template>\n  <canvas ref=\"canvas\" @click=\"playNote($event)\"></canvas>\n</template>\n\n<script>\nimport BufferLoader from '../classes/music-canvas/BufferLoader.js'\nimport Audio from '../classes/music-canvas/Audio.js'\nimport View from '../classes/music-canvas/View.js'\n\nexport default {\n  name: 'MusicCanvas',\n  data() {\n    return {\n      audio: new Audio(),\n      view: { handleClick: () => {} },\n    }\n  },\n  created() {\n    new BufferLoader(\n      this.audio.audioContext,\n      [\n        'A4.mp3',\n        'A5.mp3',\n        'C4.mp3',\n        'C5.mp3',\n        'D4.mp3',\n        'D5.mp3',\n        'E4.mp3',\n        'E5.mp3',\n        'G4.mp3',\n        'G5.mp3',\n      ],\n      bufferList => {\n        this.audio.init(bufferList)\n        this.view = new View(this.$refs.canvas, this.audio)\n      },\n    ).load()\n  },\n  mounted() {\n    const setCanvasSize = () => {\n      this.$refs.canvas.width = window.innerWidth\n      this.$refs.canvas.height = window.innerHeight\n    }\n    setCanvasSize()\n    window.onresize = setCanvasSize\n  },\n  methods: {\n    playNote(e) {\n      this.view.handleClick.bind(this.view)\n      this.view.handleClick(e)\n    },\n  },\n  watch: {\n    view: function(newView) {\n      if (newView.updateDisplay && newView.frameRate) {\n        setInterval(\n          this.view.updateDisplay.bind(this.view),\n          this.view.frameRate,\n        )\n      }\n    },\n  },\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MusicCanvas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MusicCanvas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MusicCanvas.vue?vue&type=template&id=3293a5a4&\"\nimport script from \"./MusicCanvas.vue?vue&type=script&lang=js&\"\nexport * from \"./MusicCanvas.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","var $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n"],"sourceRoot":""}