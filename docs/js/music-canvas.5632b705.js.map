{"version":3,"sources":["webpack:///./src/views/MusicCanvas.vue?5286","webpack:///./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./src/classes/music-canvas/BufferLoader.js","webpack:///./src/classes/music-canvas/Audio.js","webpack:///./src/classes/music-canvas/View.js","webpack:///src/views/MusicCanvas.vue","webpack:///./src/views/MusicCanvas.vue?30e9","webpack:///./src/views/MusicCanvas.vue","webpack:///./node_modules/core-js/internals/array-fill.js","webpack:///./node_modules/core-js/modules/es.array.fill.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticRenderFns","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","BufferLoader","context","urlList","callback","onload","bufferList","Array","loadCount","url","index","request","XMLHttpRequest","open","responseType","decodeAudioData","response","buffer","alert","error","onerror","send","loadBuffer","Audio","gainNode","undefined","audioContext","window","AudioContext","webkitAudioContext","createGain","gain","value","connect","destination","sound","createBufferSource","start","stop","currentTime","View","canvas","audio","clicks","frameRate","loopRate","maxRadius","event","view","x","offsetX","y","offsetY","pos","push","radius","play","setInterval","getContext","clearRect","width","height","fillStyle","fillRect","circle","alpha","drawCircle","beginPath","arc","Math","PI","fill","name","mounted","setCanvasSize","onresize","init","updateDisplay","bind","bufferLoader","load","component","toObject","toAbsoluteIndex","toLength","module","exports","O","argumentsLength","arguments","end","endPos","$","addToUnscopables","proto"],"mappings":"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","file":"js/music-canvas.5632b705.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{ref:\"canvas\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","class BufferLoader {\n  constructor(context, urlList, callback) {\n    this.context = context\n    this.urlList = urlList\n    this.onload = callback\n    this.bufferList = new Array()\n    this.loadCount = 0\n  }\n\n  loadBuffer(url, index) {\n    // Load buffer asynchronously\n    const request = new XMLHttpRequest()\n    request.open('GET', url, true)\n    request.responseType = 'arraybuffer'\n    request.onload = () => {\n      // Asynchronously decode the audio file data in request.response\n      this.context.decodeAudioData(\n        request.response,\n        buffer => {\n          if (!buffer) {\n            alert('error decoding file data: ' + url)\n            return\n          }\n          this.bufferList[index] = buffer\n          if (++this.loadCount == this.urlList.length)\n            this.onload(this.bufferList)\n        },\n        error => {\n          alert('decodeAudioData error', error)\n        },\n      )\n    }\n    request.onerror = () => {\n      alert('BufferLoader: XHR error')\n    }\n    request.send()\n  }\n\n  load() {\n    for (let i = 0; i < this.urlList.length; ++i) {\n      this.loadBuffer(`audio/${this.urlList[i]}`, i)\n    }\n  }\n}\n\nexport default BufferLoader\n","class Audio {\n  constructor() {\n    this.gainNode = undefined\n    this.bufferList = undefined\n    this.audioContext = new (window.AudioContext || window.webkitAudioContext)()\n  }\n\n  init(bufferList) {\n    this.bufferList = bufferList\n    this.gainNode = this.audioContext.createGain()\n    this.gainNode.gain.value = 1\n    this.gainNode.connect(this.audioContext.destination)\n  }\n\n  play(i) {\n    const sound = this.audioContext.createBufferSource()\n    sound.connect(this.gainNode)\n    sound.buffer = this.bufferList[i]\n    sound.start(0)\n    sound.stop(this.audioContext.currentTime + 18)\n  }\n}\n\nexport default Audio\n","class View {\n  constructor(canvas, audio) {\n    this.canvas = canvas\n    this.audio = audio\n    this.clicks = []\n    this.frameRate = 1000 / 30\n    this.loopRate = 4000\n    this.maxRadius = 80\n  }\n\n  handleClick(event) {\n    const view = this\n    const x = event.offsetX\n    const y = event.offsetY\n    const pos = view.clicks.push({ x: x, y: y, radius: 0 })\n    view.audio.play(x % 10)\n    setInterval(function() {\n      view.clicks[pos - 1].radius = 0\n      view.audio.play(x % 10)\n    }, view.loopRate)\n  }\n\n  updateDisplay() {\n    const view = this\n    const context = view.canvas.getContext('2d')\n    context.clearRect(0, 0, view.canvas.width, view.canvas.height)\n    context.fillStyle = 'black'\n    context.fillRect(0, 0, view.canvas.width, view.canvas.height)\n    for (let i = 0; i < view.clicks.length; i++) {\n      const circle = view.clicks[i]\n      if (circle.radius > view.maxRadius) continue\n      circle.radius += 1\n      let alpha = 0.7\n      if (circle.radius > view.maxRadius - 15)\n        alpha = (view.maxRadius - circle.radius) / 10\n      view.drawCircle(context, circle.x, circle.y, circle.radius, alpha)\n    }\n  }\n\n  drawCircle(context, x, y, radius, alpha) {\n    context.beginPath()\n    context.arc(x, y, radius, 0, 2 * Math.PI)\n    context.fillStyle =\n      'rgba(' +\n      (x % 256) +\n      ', ' +\n      (y % 256) +\n      ', ' +\n      ((x * y) % 256) +\n      ' ,' +\n      alpha +\n      ')'\n    context.fill()\n  }\n}\n\nexport default View\n","<template>\n  <canvas ref=\"canvas\"></canvas>\n</template>\n\n<script>\nimport BufferLoader from '../classes/music-canvas/BufferLoader.js'\nimport Audio from '../classes/music-canvas/Audio.js'\nimport View from '../classes/music-canvas/View.js'\n\nexport default {\n  name: 'MusicCanvas',\n  mounted() {\n    const setCanvasSize = () => {\n      this.$refs.canvas.width = window.innerWidth\n      this.$refs.canvas.height = window.innerHeight\n    }\n    setCanvasSize()\n    window.onresize = setCanvasSize\n\n    const audio = new Audio()\n\n    const finishedLoading = bufferList => {\n      audio.init(bufferList)\n      const view = new View(this.$refs.canvas, audio)\n      this.$refs.canvas.addEventListener(\n        'mousedown',\n        view.handleClick.bind(view),\n        false,\n      )\n      setInterval(view.updateDisplay.bind(view), view.frameRate)\n    }\n\n    const bufferLoader = new BufferLoader(\n      audio.audioContext,\n      [\n        'A4.mp3',\n        'A5.mp3',\n        'C4.mp3',\n        'C5.mp3',\n        'D4.mp3',\n        'D5.mp3',\n        'E4.mp3',\n        'E5.mp3',\n        'G4.mp3',\n        'G5.mp3',\n      ],\n      finishedLoading,\n    )\n    bufferLoader.load()\n  },\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MusicCanvas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MusicCanvas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MusicCanvas.vue?vue&type=template&id=2e4f3f4b&\"\nimport script from \"./MusicCanvas.vue?vue&type=script&lang=js&\"\nexport * from \"./MusicCanvas.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","var $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n"],"sourceRoot":""}